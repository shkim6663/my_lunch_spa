<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì ë©”ì¶” SPA</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="card-main" id="mainCard">
    <h2>ğŸ± ì ë©”ì¶” SPA</h2>
    <div class="form-actions">
        <button id="showFormBtn" class="btn btn-primary">ë©”ë‰´ ë“±ë¡</button>
        <button id="showListBtn" class="btn btn-secondary">ë©”ë‰´ ëª©ë¡</button>
    </div>


    <div id="formContainer" style="display:none; margin-top:30px;">
        <h2>ğŸ± ë©”ë‰´ ë“±ë¡ / ìˆ˜ì •</h2>
        <form id="menuForm">
            <label for="name">ë©”ë‰´ ì´ë¦„</label>
            <input type="text" id="name" required>

            <label for="spicy">ë§µê¸° (1~10)</label>
            <input type="number" id="spicy" min="1" max="10" required>

            <label for="price">ê°€ê²©</label>
            <input type="number" id="price" required>

            <input type="hidden" id="menuIndex">

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">ì €ì¥</button>
                <button type="button" id="cancelBtn" class="btn btn-secondary">ì·¨ì†Œ</button>
            </div>
        </form>
    </div>

    <!-- ëª©ë¡ -->
    <div id="listContainer" style="display:none; margin-top:30px;">
        <h2>ğŸ“‹ ë©”ë‰´ ëª©ë¡</h2>
        <ul id="menuList"></ul>

        <div class="form-actions mt-3">
            <button id="randomBtn" class="btn btn-primary">ëœë¤ ì¶”ì²œ</button>
            <p id="randomResult"></p>
        </div>
    </div>
</div>

<script>
    // ---------- Storage ----------
    function getMenus() {
        const data = localStorage.getItem("menus");
        return data ? JSON.parse(data) : [];
    }
    function addMenu(menu) {
        const menus = getMenus();
        menus.push(menu);
        localStorage.setItem("menus", JSON.stringify(menus));
    }
    function updateMenu(index, menu) {
        const menus = getMenus();
        menus[index] = menu;
        localStorage.setItem("menus", JSON.stringify(menus));
    }
    function deleteMenu(index) {
        const menus = getMenus();
        menus.splice(index, 1);
        localStorage.setItem("menus", JSON.stringify(menus));
    }

    // ---------- UI ----------
    const showFormBtn = document.getElementById("showFormBtn");
    const showListBtn = document.getElementById("showListBtn");
    const formContainer = document.getElementById("formContainer");
    const listContainer = document.getElementById("listContainer");
    const cancelBtn = document.getElementById("cancelBtn");
    const menuForm = document.getElementById("menuForm");
    const menuIndexInput = document.getElementById("menuIndex");
    const menuListEl = document.getElementById("menuList");
    const randomBtn = document.getElementById("randomBtn");
    const randomResult = document.getElementById("randomResult");

    // ---------- í™”ë©´ ì „í™˜ ----------
    function showForm(editIndex=null) {
        formContainer.style.display = "block";
        listContainer.style.display = "none";

        if(editIndex !== null) {
            const menus = getMenus();
            const menu = menus[editIndex];
            document.getElementById("name").value = menu.name;
            document.getElementById("spicy").value = menu.spicy;
            document.getElementById("price").value = menu.price;
            menuIndexInput.value = editIndex;
        } else {
            menuForm.reset();
            menuIndexInput.value = "";
        }
    }

    function showList() {
        formContainer.style.display = "none";
        listContainer.style.display = "block";
        renderList();
    }

    // ---------- ë²„íŠ¼ ì´ë²¤íŠ¸ ----------
    showFormBtn.addEventListener("click", () => showForm());
    showListBtn.addEventListener("click", showList);
    cancelBtn.addEventListener("click", showList);

    // ---------- í¼ ì œì¶œ ----------
    menuForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const menu = {
            name: document.getElementById("name").value,
            spicy: Number(document.getElementById("spicy").value),
            price: Number(document.getElementById("price").value)
        };

        const index = menuIndexInput.value;
        if(index) {
            updateMenu(index, menu);
        } else {
            addMenu(menu);
        }

        showList(); // ë“±ë¡ í›„ ëª©ë¡ í™”ë©´ ë³´ì—¬ì£¼ê¸°
    });

    // ---------- ëª©ë¡ ë Œë”ë§ ----------
    function renderList() {
        const menus = getMenus();
        menuListEl.innerHTML = "";

        if(menus.length === 0) {
            menuListEl.innerHTML = "<li>ë“±ë¡ëœ ë©”ë‰´ê°€ ì—†ìŠµë‹ˆë‹¤.</li>";
            return;
        }

        menus.forEach((menu,index)=>{
            const li = document.createElement("li");
            li.className = "menu-item";
            li.innerHTML = `
            ${menu.name} (ë§µê¸°: ${menu.spicy}, ê°€ê²©: ${menu.price}ì›)
            <span>
                <button onclick="showForm(${index})" class="btn btn-primary btn-sm">ìˆ˜ì •</button>
                <button onclick="deleteMenu(${index}); renderList();" class="btn btn-secondary btn-sm">ì‚­ì œ</button>
            </span>
        `;
            menuListEl.appendChild(li);
        });
    }

    // ---------- ëœë¤ ì¶”ì²œ ----------
    randomBtn.addEventListener("click", ()=>{
        const menus = getMenus();
        if(menus.length===0){
            randomResult.textContent = "ì¶”ì²œí•  ë©”ë‰´ê°€ ì—†ìŠµë‹ˆë‹¤ ğŸ˜¢";
            return;
        }
        const randomIndex = Math.floor(Math.random()*menus.length);
        const menu = menus[randomIndex];
        randomResult.textContent = `ì˜¤ëŠ˜ì˜ ì¶”ì²œ ë©”ë‰´ ğŸ‘‰ ${menu.name} (${menu.price}ì›)`;
    });

    showList();
</script>
</body>
</html>

